<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lupa Password - Lab Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .dino-mascot { font-size: 4rem; display: inline-block; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 h-screen flex items-center justify-center overflow-hidden">

    <div class="absolute top-10 left-10 w-20 h-20 bg-white rounded-full opacity-10 animate-bounce"></div>
    <div class="absolute bottom-20 right-20 w-32 h-32 bg-white rounded-full opacity-10 animate-pulse"></div>

    <div class="glass-card p-8 rounded-2xl shadow-2xl w-96 text-center transform transition-all duration-500 hover:shadow-pink-500/50 relative z-10">
        
        <div class="mb-4">
            <div class="dino-mascot">ü¶ñ</div>
        </div>

        <h2 class="text-2xl font-extrabold text-gray-800 mb-2">LUPA PASSWORD?</h2>
        <p class="text-gray-600 text-sm mb-6">Jangan panik! Masukkan email kampusmu, nanti Dino kirim kode rahasia.</p>
        
        <div id="request-area">
            <form onsubmit="handleResetRequest(event)">
                <div class="mb-6 text-left">
                    <label class="block text-xs font-bold text-gray-600 mb-1 ml-1">EMAIL TERDAFTAR</label>
                    <input type="email" id="resetEmail" required
                        class="w-full p-3 rounded-xl border-2 border-transparent bg-white/50 focus:bg-white focus:border-pink-400 focus:ring-4 focus:ring-pink-200 outline-none transition-all" 
                        placeholder="user@lab.com">
                </div>

                <button type="submit" id="btnSubmit"
                    class="w-full bg-gradient-to-r from-pink-600 to-purple-600 text-white p-3 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl hover:scale-105 active:scale-95 transition-all duration-200">
                    KIRIM KODE üöÄ
                </button>
            </form>
            
            <div class="mt-6 text-xs">
                <a href="test_admin.html" class="text-indigo-600 font-bold hover:underline">‚Üê Kembali ke Login</a>
            </div>
        </div>

<div id="success-area" class="hidden animate-pulse">
    <div class="bg-green-100 border border-green-200 text-green-700 p-4 rounded-xl mb-4 text-sm font-bold">
        ‚úÖ Kode reset terkirim! Cek Inbox/Spam.
    </div>
    
    <button onclick="goToResetPage()" class="block w-full bg-indigo-600 text-white p-3 rounded-xl font-bold hover:bg-indigo-700 shadow-lg">
        Masukkan Kode Reset ‚û°
    </button>
</div>

    </div>

    <script>
        const API_RESET_URL = 'http://localhost/inlet-project/public/index.php?url=auth/forgot_password'; 

        function handleResetRequest(e) {
            e.preventDefault();
            
            const email = document.getElementById('resetEmail').value;
            const btn = document.getElementById('btnSubmit');
            
            const originalText = btn.innerText;
            btn.innerText = "Mengirim... üì®";
            btn.disabled = true;
            btn.classList.add('opacity-70', 'cursor-not-allowed');

            fetch(API_RESET_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: email })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    document.getElementById('request-area').classList.add('hidden');
                    document.getElementById('success-area').classList.remove('hidden');
                } else {
                    alert("Gagal: " + (data.message || "Email tidak ditemukan!"));
                    resetButton();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert("Terjadi kesalahan koneksi. Coba lagi nanti.");
                resetButton();
            });

            function resetButton() {
                btn.innerText = originalText;
                btn.disabled = false;
                btn.classList.remove('opacity-70', 'cursor-not-allowed');
            }
        }

        function goToResetPage() {
            const email = document.getElementById('resetEmail').value;
            
            window.location.href = 'reset_password.html?email=' + encodeURIComponent(email);
        }
    </script>
</body>
</html>